{% if jekyll.environment == "production" and site.ga_measurement_id %}
  <!-- Google Analytics (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.ga_measurement_id }}"></script>
  <script>
    // Respect "Do Not Track" (optional)
    var dnt = navigator.doNotTrack == "1" || window.doNotTrack == "1" || navigator.msDoNotTrack == "1";
    if (!dnt) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      gtag('js', new Date());
      // GA4 anonymizes IP by default; the next option is harmless if left in
      gtag('config', '{{ site.ga_measurement_id }}', { 'anonymize_ip': true });
    }
  </script>
{% endif %}
